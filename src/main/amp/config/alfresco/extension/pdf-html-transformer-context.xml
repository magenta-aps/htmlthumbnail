<?xml version='1.0' encoding='UTF-8'?>
<!DOCTYPE beans PUBLIC '-//SPRING//DTD BEAN//EN' 'http://www.springframework.org/dtd/spring-beans.dtd'>

<beans>
    <bean id="transformer.worker.pdfToHtmlPy"
          class="org.alfresco.repo.content.transform.RuntimeExecutableContentTransformerWorker">
        <property name="mimetypeService">
            <ref bean="mimetypeService"/>
        </property>
        <property name="checkCommand">
            <bean class="org.alfresco.util.exec.RuntimeExec">
                <property name="commandsAndArguments">
                    <map>
                        <entry key=".*">
                            <list>
                                <value>${python.exe}</value>
                                <value>--version</value>
                            </list>
                        </entry>
                    </map>
                </property>
                <!--<property name="errorCodes">
                    <value>1</value>
                </property>-->
            </bean>
        </property>
        <property name="transformCommand">
            <bean class="org.alfresco.util.exec.RuntimeExec">
                <property name="commandsAndArguments">
                    <map>
                        <entry key=".*">
                            <list>
                                <value>${python.exe}</value>
                                <!--until we figure out how to resolve the classpath-->
                                <!--<value>classpath:alfresco/extension/scripts/python/excel2html.py</value>-->
                                <!-- For now we just add it to the global.properties to retrieve the path-->
                                <value>${python.pdfToHtml.script}</value>
                                <value>${source}</value>
                                <value>${target}</value>
                            </list>
                        </entry>
                    </map>
                </property>
            </bean>
        </property>
        <property name="explicitTransformations">
            <!--For mimetypes list see: -->
            <!--https://github.com/Alfresco/community-edition/blob/3b6fdc1c77659d5160e8f2021cccb9db26902ee4/projects/
            repository/config/alfresco/mimetype/openoffice-document-formats.xml-->
            <list>
                <!--pdf-->
                <bean class="org.alfresco.repo.content.transform.ExplictTransformationDetails">
                    <!--source mimetype-->
                    <constructor-arg value="application/pdf"/>
                    <!--target mimetype-->
                    <constructor-arg value="text/html"/>
                </bean>
            </list>
        </property>
    </bean>

    <bean id="transformer.pdfToHtmlPy" class="org.alfresco.repo.content.transform.ProxyContentTransformer"
          init-method="register"
          parent="baseContentTransformer">
        <property name="worker" ref="transformer.worker.pdfToHtmlPy"/>
        <property name="registry" ref="contentTransformerRegistry"/>
        <property name="registerTransformer" value="true"/>
    </bean>
</beans>